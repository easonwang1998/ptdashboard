<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é­šé®®æœƒç¤¾ PT å…¨å“¡è€ƒæ ¸é€²åº¦é¢æ¿</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #f8f9fa; margin: 0; padding: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .header h2 { color: #1a73e8; margin-bottom: 10px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; max-width: 1200px; margin: auto; }
        .card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border-left: 5px solid #ddd; transition: transform 0.2s; }
        .card:hover { transform: translateY(-5px); }
        .card.L1 { border-left-color: #cd7f32; } /* éŠ… */
        .card.L2 { border-left-color: #c0c0c0; } /* éŠ€ */
        .card.L3 { border-left-color: #ffd700; } /* é‡‘ */
        .name-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .name { font-size: 1.2em; font-weight: bold; color: #202124; }
        .badge { padding: 4px 10px; border-radius: 8px; font-size: 12px; font-weight: bold; background: #eee; }
        .stat { font-size: 14px; color: #5f6368; margin: 5px 0; }
        .progress-container { background: #e8eaed; border-radius: 10px; height: 12px; width: 100%; margin: 15px 0 10px 0; overflow: hidden; }
        .progress-bar { background: linear-gradient(90deg, #4285f4, #34a853); height: 100%; transition: width 1s; }
        .percent-text { font-size: 12px; font-weight: bold; color: #1a73e8; float: right; }
        .remain-tag { font-size: 13px; font-weight: bold; padding: 8px; border-radius: 5px; text-align: center; margin-top: 10px; }
        .status-ready { background: #e6f4ea; color: #1e8e3e; } /* é”æ¨™ */
        .status-wait { background: #fce8e6; color: #d93025; } /* ç´¯ç©ä¸­ */
    </style>
</head>
<body>

<div class="header">
    <h2>ğŸ£ é­šé®®æœƒç¤¾ PT å…¨å“¡é€²åº¦é¢æ¿</h2>
    <div id="loading" style="color: #666;">è³‡æ–™åŒæ­¥ä¸­...</div>
</div>

<div class="grid" id="dataGrid">
    </div>

<script>
    // ã€é‡è¦ã€‘æ›¿æ›æˆä½ çš„ CSV ç¶²å€
    const csvUrl = 'ä½ çš„GOOGLEè©¦ç®—è¡¨CSVç™¼ä½ˆç¶²å€';

    Papa.parse(csvUrl, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
            document.getElementById('loading').style.display = 'none';
            renderCards(results.data);
        }
    });

    function renderCards(data) {
        const grid = document.getElementById('dataGrid');
        grid.innerHTML = ""; // æ¸…ç©º

        data.forEach(user => {
            if (!user["å§“å"]) return; // è·³éç©ºè¡Œ

            // è®€å–æ•¸æ“š
            const name = user["å§“å"].trim();
            const lvl = user["ç­‰ç´š"] || "L1";
            const total = parseFloat(user["ä¸Šç­æ™‚æ•¸"]) || 0;
            const base = parseFloat(user["æ™‰å‡æ™‚ç¸½æ™‚æ•¸"]) || 0;
            const target = parseFloat(user["ä¸‹æ¬¡è€ƒæ ¸é–€æª»"]) || 0;
            const currentPeriod = parseFloat(user["æœ¬è·ç´šç´¯ç©æ™‚æ•¸"]) || (total - base);

            // è¨ˆç®—é€²åº¦
            const goal = target - base;
            let percent = 0;
            if (goal > 0) {
                percent = Math.min(Math.round((currentPeriod / goal) * 100), 100);
            }
            const remain = Math.max(0, target - total);

            // å»ºç«‹å¡ç‰‡ HTML
            const card = document.createElement('div');
            card.className = `card ${lvl}`;
            
            const statusClass = remain <= 0 ? 'status-ready' : 'status-wait';
            const statusText = remain <= 0 ? 'âœ¨ å·²é”è€ƒæ ¸é–€æª»' : `è·é›¢è€ƒæ ¸å·® ${remain} H`;

            card.innerHTML = `
                <div class="name-row">
                    <span class="name">${name}</span>
                    <span class="badge">${lvl}</span>
                </div>
                <div class="stat">ç”Ÿæ¶¯ç¸½æ™‚æ•¸: <b>${total}</b> H</div>
                <div class="stat">è·ç´šèµ·é»: ${base} H / ç›®æ¨™: ${target} H</div>
                
                <div class="progress-container">
                    <div class="progress-bar" style="width: ${percent}%"></div>
                </div>
                <span class="percent-text">é€²åº¦ ${percent}%</span>
                <div style="clear:both"></div>
                
                <div class="remain-tag ${statusClass}">${statusText}</div>
            `;
            grid.appendChild(card);
        });
    }
</script>

</body>
</html>
