<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é­šé®®æœƒç¤¾ PT è·èƒ½å„€è¡¨æ¿</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body { font-family: sans-serif; background-color: #f4f4f9; padding: 20px; color: #333; }
        .container { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #1a73e8; }
        .search-box { margin-bottom: 20px; text-align: center; }
        input { padding: 10px; width: 70%; border: 1px solid #ddd; border-radius: 5px; }
        .card { display: none; border-top: 2px solid #eee; padding-top: 20px; }
        .stat { display: flex; justify-content: space-between; margin: 10px 0; }
        .progress-container { background: #eee; border-radius: 10px; height: 25px; width: 100%; margin: 15px 0; overflow: hidden; }
        .progress-bar { background: linear-gradient(90deg, #4caf50, #8bc34a); height: 100%; width: 0%; transition: width 0.5s; text-align: center; color: white; font-size: 14px; line-height: 25px; }
        .badge { display: inline-block; padding: 5px 15px; border-radius: 20px; color: white; font-weight: bold; background: #f39c12; }
        .info-text { font-size: 0.9em; color: #666; text-align: center; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ£ é­šé®®æœƒç¤¾ PT å„€è¡¨æ¿</h2>
    <div class="search-box">
        <input type="text" id="nameInput" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å..." oninput="searchData()">
    </div>

    <div id="resultCard" class="card">
        <div class="stat"><span>ç›®å‰ç­‰ç´š:</span> <span id="lvl" class="badge"></span></div>
        <div class="stat"><span>ç”Ÿæ¶¯ç¸½æ™‚æ•¸:</span> <b id="totalHrs"></b> H</div>
        <div class="progress-container">
            <div id="pBar" class="progress-bar">0%</div>
        </div>
        <div id="diffText" style="text-align: center; font-weight: bold; color: #e74c3c;"></div>
        <p class="info-text">é€²åº¦æ¢æ ¹æ“šç•¶å‰è·ç´šè€ƒæ ¸ç›®æ¨™è¨ˆç®—</p>
    </div>
</div>

<script>
    // ã€ä¿®æ”¹é‡é»ã€‘è«‹æŠŠä¸‹é¢é€™è¡Œå¼•è™Ÿå…§çš„ç¶²å€ï¼Œæ›æˆä½ å‰›å‰›åœ¨ Google è©¦ç®—è¡¨ç™¼ä½ˆçš„ CSV ç¶²å€
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSPKyIVGlT4rmWEOUPwSdccHGWEaGPF3QhMm0rXnh7g_0kJx9iXFzIGVoY_uWOUHN9La8KjZOp5BMAv/pub?output=csv';

    let ptData = [];

    // æŠ“å–è³‡æ–™
    Papa.parse(csvUrl, {
        download: true,
        header: true,
        complete: function(results) {
            ptData = results.data;
        }
    });

    function searchData() {
        const name = document.getElementById('nameInput').value.trim();
        const card = document.getElementById('resultCard');
        
        const user = ptData.find(row => row.å§“å === name);

        if (user && name !== "") {
            card.style.display = 'block';
            document.getElementById('lvl').innerText = user.ç­‰ç´š;
            document.getElementById('totalHrs').innerText = user.ä¸Šç­æ™‚æ•¸;

            // è¨ˆç®—é‚è¼¯
            let current = parseFloat(user.ä¸Šç­æ™‚æ•¸) || 0;
            let base = parseFloat(user.æ™‰å‡æ™‚ç¸½æ™‚æ•¸) || 0;
            let target = parseFloat(user.ä¸‹æ¬¡è€ƒæ ¸é–€æª») || 0;
            
            let thisPeriod = current - base;
            let goal = target - base;
            let percent = Math.min(Math.round((thisPeriod / goal) * 100), 100);
            
            document.getElementById('pBar').style.width = percent + '%';
            document.getElementById('pBar').innerText = percent + '%';
            document.getElementById('diffText').innerText = "è·é›¢è€ƒæ ¸é‚„å·® " + Math.max(0, target - current) + " å°æ™‚";
        } else {
            card.style.display = 'none';
        }
    }
</script>

</body>
</html>
